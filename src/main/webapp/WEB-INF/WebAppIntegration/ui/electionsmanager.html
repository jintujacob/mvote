
<style>
		*{
		    margin:0px;
		    padding:0px;
		}
		
		div{
		    border: 1px solid black;
		    overflow:auto;
		}
		
		.clearLine{
		    margin-top:10px;
		    clear:both;
		}    
		
		
		
		span{   
		     float:left; 
		     border:1px solid red;  
		     min-height:200px;  
		    }
		
		
		#pageElectionSearchSummary td{
		    border:1px solid #ccc;
		}
		
		    #pageElectionSearchSummary a{
		            display: block;
		            padding:3px;
		            border:1px solid blue;
		        }
		    
		        #pageElectionSearchSummary a:hover{
		            border:1px solid red;
		        }
		        
		        #pageElectionSearchSummary a:active{
		            background:#ccc;
		        }
		        
		#panelLeftElectionDetail div{
		    width:100%;
		}
		
		
		
		#panelLeftElectionBasic{
		    
		    padding:20px;
		    
		}
		
		#panelRightElectionStates table td{
		    margin:0;
		    padding:0;
		    padding-top: 10px;
		}
		
</style>

</head>
<body>
<div id="container">
    <div id="pageElectionsHome">
        Elections Manager<br>
       <span id="panelLeftHomePage">
           <p> 
                <button id="goto_search_ele"> Search </button> <br/>
                <button id="goto_add_ele"> Add New </button>         
           </p>
       </span>
    
       <span id="panelRightHomePage">
            <div id="contentSearchElectionForm">
                   Search Elections	 <br><br>
                   Title :   <input type="text" id="in_find_ele"> <br>
                   <button id="btn_search_ele"> Find </button>
                   
            </div>
            <div id="contentAddElectionForm">
                   contentAddElectionForm <br><br>
                   Title :   <input type="text" id="in_add_title"> <br>
                   Desc :   <input type="text" id="in_add_desc"> <br>
                   From Date :   <input type="text" id="in_add_fromdt"> (yyyy-mm-dd)<br>
                   To Date :   <input type="text" id="in_add_todt"> (yyyy-mm-dd)<br>
                   
                   <button id="btn_add_ele"> Register </button>
                   
           </div>
       </span>
    </div>
    
    <div id="pageAddElectionStatesForm">
        <!-- pageAddElectionStatesForm --><br>
        <span id="panelLeftElectionBasic">
            
            
            <br>
            <b>Basic Election Information </b>
            
            <table id="tbl_basicElectionInfoAdd">  <!-- ajax it  --> </table>
            
            
            
            
        </span>
        <span id="panelRightElectionStates">
            panelRightElectionStates<br><br>
            
            states selections <br>
            
            <input type="checkbox"> test
            <table >
            	<tr> 
            		<td class="statesListLeft">  <!-- ajax it  --></td>
            		<td class="statesListRight">  <!-- ajax it --></td>
            	</tr>
            </table>
           
       
            <button id="btn_add_states"> Add States</button>
        </span>
    </div>
    
    <div id="pageElectionSearchSummary">
       pageElectionSearchSummary
       <table id="tableElectionsSearchResults">
            <thead>
                <tr>   
                   <td>Election Id </td> 
                   <td>Title</td> 
                   <td>Start Date</td> 
                   <td>End Date</td>
                   <td>Voter Enrollment Status</td>  </tr>
            </thead>
            <tbody>  <!-- ajax it --> </tbody>
       </table>
       
    </div>
    
    <div id="pageElectionDetail">
        pageElectionDetail <br>
        <span id="panelLeftElectionDetail">
            
            <div id="tableBasicEleDetail">
                Basic info
            </div>
            <div id="divEleStatesList">
                <p> Applicable States </p><br>    
            </div>
            
        </span>
        <span id="panelRightElectionDetail">
            panelRightElectionDetail <br>
           <!--  <button id="btn_update"> Update</button><br/> -->
            <button id="btn_delete"> Delete</button>
            <button id="btn_enroll_voters"> Enroll Voters for the election </button>
            buttons
        </span>
    </div>
</div>    

<script type="text/javascript">
			__addTitle = "";
			__addDesc = "";
			__addFromDt = "";
			__addToDt = "";
			
			
			__allStates = "";
			
			host  = "http://localhost:8080/mvote" ;
			
			_elctionListResponse = "";
			    
			$(document).ready(function()
			{
			    getAllStatesList();
			    showPageHome();
			    
			    $('#goto_search_ele').click(function(){
			        $('#contentAddElectionForm').hide();
			        $('#contentSearchElectionForm').show();
			    });
			    
			    $('#goto_add_ele').click(function(){
			        $('#contentAddElectionForm').show();
			        $('#contentSearchElectionForm').hide();
			    });
			    
			    $('#btn_search_ele').click(function(){
			        searchKey = $("#in_find_ele").val();
			        processElectionsSearch(searchKey);
			    });
			    
			    $('#btn_add_ele').click(function(){
			        processElectionAddition();
			    });
			    
			    $('#btn_add_states').click(function(){
			        submitElectionInfo();
			        //processElectionsSearch();
			        //showPage('#pageElectionSearchSummary');
			    });
			    
			    $('#btn_enroll_voters').click(function(){
			        electId = "33";
			        enrollVotersForElection(electId);
			    });
			    
			    $('#btn_delete').click(function(){
			        electId = "33";
			        deleteElection(electId);
			    });
			
			    
			    
			    
			    
			    
			/*  $('#pageAddElectionStatesForm input[type=checkbox]').change(function(){
			        alert(this.val());
			        
			    });
			*/
			    
			    $("body").on("change", "#pageAddElectionStatesForm input[type=checkbox]", function(event){
			        alert('gotClicked');
			        alert($("#pageAddElectionStatesForm input[type=checkbox]").val());
			    });
			            
			    
			});
			
			
			function deleteElection(electId)
			{
			    obj = { "electId": electId  };
			    jsonString =JSON.stringify(obj);
			    
			    $.ajax({
			        type: "POST",
			        url: host + '/elections/deleteElection',
			        contentType: "application/json; charset=utf-8",
			        dataType: "json",
			        data: jsonString,
			        success: function(response) {
			            populateDeleteElectionStatus(response);
			        },
			        error: function(response){
			            alert("Connection Error. Network failure or Server unavailable");
			        }
			    }); 
			
			}
			
			function populateDeleteElectionStatus(response)
			{
			    if(response.customMessage == "SUCCESS"){
			        alert("Successfully Deleted Election");
			    }
			    else{
			        alert(response.customMessage);
			    }
			
			    
			}
			
			
			
			
			function enrollVotersForElection(electId)
			{
			    obj = { "electId": electId  };
			    jsonString =JSON.stringify(obj);
			    
			    $.ajax({
			        type: "POST",
			        url: host + '/elections/enrollVotersForElection',
			        contentType: "application/json; charset=utf-8",
			        dataType: "json",
			        data: jsonString,
			        success: function(response) {
			            populateVoterEnrollStatus(response);
			        },
			        error: function(response){
			            alert("Connection Error. Network failure or Server unavailable");
			        }
			    }); 
			
			}
			
			function populateVoterEnrollStatus(response)
			{
			    if(response.customMessage == "SUCCESS"){
			        alert("Successfully Enrolled Voters");
			    }
			    else{
			        alert(response.customMessage);
			    }
			
			}
			
		
			
			function submitElectionInfo()
			{
			    obj = { "electTitle":__addTitle ,
			            "electStartDate" : __addFromDt,
			            "electEndDate" : __addToDt,
			            "electDescription" : __addDesc
			          };
			    
			    jsonString =JSON.stringify(obj);
			    
			    $.ajax({
			        type: "POST",
			        url: host + '/elections/addNewElection',
			        contentType: "application/json; charset=utf-8",
			        dataType: "json",
			        data: jsonString,
			        success: function(response) {
			            populateSubmitResult(response);
			        },
			        error: function(response){
			            alert("Connection Error. Network failure or Server unavailable");
			        }
			    }); 
			
			}
			
			
			function populateSubmitResult(response)
			{
			    if(response.customMessage == "SUCCESS"){
			        alert("Successfully added election");
			        showPageHome();
			    }
			    else{
			        alert(response.customMessage);
			    }
			    
			}
			
			
			function getAllStatesList()
			{
			    $.ajax({
			        type: "POST",
			        url: host + '/elections/getAllStates',
			        contentType: "application/json; charset=utf-8",
			        dataType: "json",
			        success: function(response) {
			            __allStates = response.statesList;
			            loadElectionStates(__allStates);
			            
			            //processElectionAddition(__allStates);
			        },
			        error: function(response){
			            alert("Connection Error. Network failure or Server unavailable");
			        }
			    }); 
			}
			
			
			function loadElectionStates()
			{
			    //populate states list
			    
			    strLeft = "";
			    strRight = "";
			    for(i=0; i < __allStates.length; i++)
			    {
			        if(i%2 != 0 )
			        {
			            strLeft +=  " <input type='checkbox' name='check"+ __allStates[i].stateId 
			                    + "' value='"+ __allStates[i].stateId +"'/> "
			                    + __allStates[i].stateName +" <br>" ;
			            //console.log(strLeft);
			        }else{
			            strRight +=  " <input type='checkbox' name='check"+ __allStates[i].stateId 
			                + "' value='"+ __allStates[i].stateId +"'/> "
			                + __allStates[i].stateName +" <br>" ;
			            
			            //console.log(strRight);
			        }
			    }
			
			    $('.statesListLeft').html(strLeft);
			    $('.statesListRight').html(strRight);
			
			    
			    //load elections states on the add elections form dropdown
			}
			
			
			function populateElectionDetail(electId)
			{
			    getElectionDetailBasic(electId);
			    getElectionDetailStates(electId);
			    showPage('#pageElectionDetail');
			
			}
			
			
			function getElectionDetailBasic(electId)
			{
			    obj = { "electId": electId};
			    jsonString =JSON.stringify(obj);
			    
			    $.ajax({
			        type: "POST",
			        url: host + '/elections/getElectionDetail',
			        contentType: "application/json; charset=utf-8",
			        dataType: "json",
			        data: jsonString,
			        success: function(response) {
			            populateBasicElectionDetail(response);
			        },
			        error: function(response){
			            alert("Connection Error. Network failure or Server unavailable");
			        }
			    }); 
			}
			
			function getElectionDetailStates(electId)
			{
			    obj = { "electId":electId };
			    jsonString =JSON.stringify(obj);
			    
			    $.ajax({
			        type: "POST",
			        url: host + '/elections/getStatesListByElection',
			        contentType: "application/json; charset=utf-8",
			        dataType: "json",
			        data: jsonString,
			        success: function(response) {
			            populateStatesElectionDetail(response);
			        },
			        error: function(response){
			            alert("unable to connect");
			        }
			    }); 
			}
			
			
			function populateStatesElectionDetail(response)
			{
				listOfStates = response.statesList;
				
				str = "";
				
				if(response.customMessage = "SUCCESS"){
					for(i=0; i<listOfStates.length; i++){
						str += "<p>";
						str += listOfStates[i].stateName ;
						str += "</p>";
					}
					
				}else{
						str += "<tr><td> "+ response.customMessage +"</td></tr>";
				}
				
				$('#divEleStatesList').append(str);
				
			
			}
			
			function populateBasicElectionDetail(response){
				
				electionDetail = response;
				str = "";
				
				if(electionDetail.customMessage = "SUCCESS"){
					str += "<tr><td> Title </td> <td>:</td> <td>" +electionDetail.electTitle + "</td></tr>";
					str += "<tr><td> Id </td> <td>:</td> <td>" +electionDetail.electId + "</td></tr>";
					str += "<tr><td> Voter Enrollment status</td> <td>:</td> <td>" +electionDetail.voterEnrollStat + "</td></tr>";
					str += "<tr><td> Start Date </td> <td>:</td> <td>" +electionDetail.electStartDate + "</td></tr>";
					str += "<tr><td> End Date</td> <td>:</td> <td>" +electionDetail.electEndDate + "</td></tr>";
					str += "<tr><td> Description</td> <td>:</td> <td>" +electionDetail.electDescription + "</td></tr>";
				}else{
						str += "<tr><td> "+ electionDetail.customMessage +"</td></tr>";
				}
				
				$('#tableBasicEleDetail').html(str);
			}
			
			
						
			
			function processElectionAddition(){
			    //get inputs , write to db, store info in js var
			    
			    __addTitle = $('#in_add_title').val();
			    __addDesc = $('#in_add_desc').val();
			    __addFromDt = $('#in_add_fromdt').val();
			    __addToDt = $('#in_add_todt').val();
			    
			/*  __addTitle ="autotestbot";
			    __addDesc = "autotestBot";
			    __addFromDt = "1111-11-11";
			    __addToDt = "1111-11-11";
			*/  
			
			    //alert(addTitle +"|"+ addDesc +"|"+ addFromDt +"|"+ addToDt);
			    
			    //populate entered info in the second page
			    if(__addTitle != "" && __addDesc != "" && __addFromDt != "" && __addToDt != "")
			    {
			        str  = "";
			        str += "<tr> <td> Election Title </td> <td>:</td>  <td>"+ __addTitle +"</td>  </tr>";
			        str += "<tr> <td> Election Description </td> <td>:</td>  <td>"+ __addDesc +"</td>  </tr>";
			        str += "<tr> <td> Election Start Date </td> <td>:</td>  <td>"+ __addFromDt +"</td>  </tr>";
			        str += "<tr> <td> Election End Date </td> <td>:</td>  <td>"+ __addToDt +"</td>  </tr>";
			        
			        showPage('#pageAddElectionStatesForm');
			        $('#tbl_basicElectionInfoAdd').html(str);
			    
			    }else{
			        alert("All fields are mandatory. Please resubmit");
			    }
			}
			
			function processElectionsSearch(searchKey){
			    obj = { "electTitle": searchKey };
			    jsonString =JSON.stringify(obj);
			    
			    $.ajax({
			        type: "POST",
			        url: host + '/elections/searchElection',
			        contentType: "application/json; charset=utf-8",
			        dataType: "json",
			        data: jsonString,
			        success: function(response) {
			        	_elctionListResponse = response;
			            populateElectionList(response);
			        },
			        error: function(response){
			            alert("Connection Error. Network failure or Server unavailable");
			        }
			    }); 
			}
			
			
			
			function populateElectionList(response)
			{
			 	str = "";
			    if(response.customMessage == "SUCCESS")
			    {
			        _elctionList = response.electionBasicDetailList;
			        for(i=0; i< _elctionList.length; i++){
			                str += "<tr>" ;
			                str +=  "<td><a onclick=populateElectionDetail("+ _elctionList[i].electId+")>"
			                			+ _elctionList[i].electId +"</a></a></td>" ;
			                str +=  "<td>"+ _elctionList[i].electTitle+"</td><td>"+ _elctionList[i].electStartDate+"</td>" ;
			                str +=  "<td>"+_elctionList[i].electEndDate+"</td><td>"+ _elctionList[i].voterEnrollStat+"</td>" ;
			                str += "</tr>" ;
			        }
			    }else {
			        str += "<tr><td colspan='5'>"+ response.customMessage +"</td></tr>"; 
			    }
			    
			    $('#tableElectionsSearchResults tbody').html(str);
			    showPage('#pageElectionSearchSummary');
			
			}
			
	
			function hideAll(){
			    $('#pageElectionsHome').hide();
			    $('#pageAddElectionStatesForm').hide();
			    $('#pageElectionSearchSummary').hide();
			    $('#pageElectionDetail').hide();
			}
			
			function showPage(pageId){
			    hideAll();
			    $(pageId).show();
			}
			
			function showPageHome(){
			    hideAll();
			    $('#pageElectionsHome').show();
			        $('#contentAddElectionForm').hide();
			            $('#contentSearchElectionForm').show();
			}





</script>
