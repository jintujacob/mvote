
<style>
	span{   
	     float:left; 
	     min-height:200px;  
    }
	
	#panelLeftHomePage{
	   width: 250px;
	}
	
	
	#panelLeftHomePage button{
	   padding:3px 5px 3px 5px;
	   width: 200px;
	   background-color:white;
	   border-top : 1px solid #ccc;
	   border-right : 1px solid #ccc;
       border-bottom : 1px solid black;
       border-left : 1px solid black;
	   margin-bottom: 20px;
	}
	
	#panelLeftHomePage button:hover{
            background-color:#A9A9F5;
    }
    
    #panelLeftHomePage button:clicked{
            background-color:#A9A9F5;
    }
    
    #panelRightHomePage{
        padding-left: 20px;
        border-left: 1px solid black;
    }
    
    
    #pageElectionSearchSummary table{
        width: 100%;
    }
    
    #pageElectionSearchSummary thead td{
        border: 1px solid black;
        padding: 2px 2px 2px 4px;
        background: #819FF7;
        font-family: Verdana;
        font-size: 13px;
        
    }
	
	#pageElectionSearchSummary tbody td{
    	    border-bottom:1px solid #ccc;
    	    padding-left: 4px;
    	    font-family: Verdana;
            font-size: 13px;
    	    
	}
	
	#pageElectionSearchSummary a{
	         display: block;
	         padding:3px;
	         border:1px solid blue;
    }
    
    #pageElectionSearchSummary a:hover{
            border:1px solid red;
    }
    
    #pageElectionSearchSummary a:active{
            background:#ccc;
    }
	        
	#panelLeftElectionDetail{
	      width: 60%;
	}
	
		
	#btn_search_ele{
	   width: 100px;
	   padding: 2px 20px 2px 20px;
	}

    #btn_add_ele{
       width: 100px;
       padding: 2px 20px 2px 20px;
    }	
    
    .bck_to_home{
        width: 200px;
        float:right;
        border: 1px solid blue;
        padding: 2px 5px 2px 5px;
        text-align: center;   
    }	
    
    .tableHeadingInSpan{
        font-family: Verdana;
        font-size: 14px;
        padding-top: 5px;
        margin-bottom:15px;
        font-weight: bold;
        
    }
    
    #pageElectionDetail table  {
        border: 1px solid black;
        width:100%;
    }
    #pageElectionDetail table td{
        padding: 2px;
        border: 1px solid #ccc;
    }
    
    #panelRightElectionDetail{
        padding-left: 80px;
    }

    #panelRightElectionDetail button{
       padding:4px 5px 4px 5px;
       width: 150px;
       background-color:#585858;
       color:white;
       border: 1px solid blue;
       margin-bottom: 50px;
    }		
    
    #tbl_basicElectionInfoAdd{
        border: 1px solid black;
        width:700px;
    }
    #tbl_basicElectionInfoAdd td{
        padding: 2px;
        margin:2px;
        border: 1px solid #ccc;
    }
    
    #btn_add_states{
        width: 100px;
        padding: 2px 20px 2px 20px;
    }
    
		
</style>


<div id="container">


	 <div class="dataContainerHeading">
	        <b>Elections Manager</b>
	        <hr/>
	 </div>
	 
	 <p class="dataContainerDescription">
            Central Election Management functions such as Creation of Election and search 
            of available Elections, Open the election for public users to start voting, 
            Stop the voting for the elections etc... Voters will be able to perform voting 
            only after the admin Start the election.  
     </p> 
	 
	  
    <div id="pageElectionsHome">
       <span id="panelLeftHomePage">
           <p> 
                <button id="goto_search_ele"> Search Elections </button> <br/>
                <button id="goto_add_ele"> Add New Election </button>         
           </p>
       </span>
    
       <span id="panelRightHomePage">
            <div id="contentSearchElectionForm">
                   <p class="containerSubHeading">
                        <b> Search Elections</b>
                   </p>	 
                   
                   Title to Search &nbsp;&nbsp; : &nbsp;&nbsp;  
                   <input type="text" id="in_find_ele"> <br><br>
                   <button id="btn_search_ele"> Find </button>
                   
            </div>
            <div id="contentAddElectionForm">
                   <p class="containerSubHeading">
                        <b> Add New Election</b>
                   </p>  
            
                   <table>
                        <tr> <td align="right"> Title : </td> <td> <input type="text" id="in_add_title"> </td> </tr>
                        <tr> <td align="right"> Desc :</td> <td>  <input type="text" id="in_add_desc">  </td> </tr>
                        <tr> <td align="right"> From Date :</td> <td>  <input type="text" id="in_add_fromdt"> (yyyy-mm-dd)  </td> </tr>
                        <tr> <td align="right"> To Date : </td> <td>  <input type="text" id="in_add_todt"> (yyyy-mm-dd)  </td> </tr>
                        <tr> <td></td> <td><br> <button id="btn_add_ele"> Register </button></td> </tr>
                   </table>
                   
                   
           </div>
       </span>
    </div>
    
    <div id="pageAddElectionStatesForm">
        <div class="bck_to_home"> Elections Home </div>

        <p class="containerSubHeading">
            <b> Elections Form</b>
        </p>  
        <span id="panelLeftElectionBasic">
            <br><p> Review the Information before submitting  </p> <br>            
            
            <table id="tbl_basicElectionInfoAdd">  <!-- ajax it  --> </table>
            <br> <br>
            <button id="btn_add_states"> Submit</button>
        </span>

        <span id="panelRightElectionStates">
        <!--
            states selections <br>
            <table >
            	<tr> 
            		<td class="statesListLeft">  ajax it </td>
            		<td class="statesListRight">  ajax it</td>
            	</tr>
            </table>
           
         -->            
        </span>
    </div>
    
    <div id="pageElectionSearchSummary">
        
        <div class="bck_to_home"> Elections Home </div>

        <p class="containerSubHeading">
            <b> Search Results</b>
        </p>  
        
       <table id="tableElectionsSearchResults">
            <thead>
                <tr>   
                   <td> <b>Election Id </b> </td> 
                   <td> <b>Title </b></td> 
                   <td> <b>Start Date</b> </td> 
                   <td> <b>End Date </b></td>
                   <td> <b>Voter Enrollment Status </b></td>  </tr>
            </thead>
            <tbody>  <!-- ajax it --> </tbody>
       </table>
       
    </div>
    
    <div id="pageElectionDetail">
        <div class="bck_to_home"> Elections Home </div>

        <p class="containerSubHeading">
            <b> Election Details</b>
        </p>
          
        <span id="panelLeftElectionDetail">
            
            <div class="tableHeadingInSpan"> Basic Election Information</div>            
            <table id="tableBasicEleDetail">
            
            </table>
            
            <br><br>
            <div class="tableHeadingInSpan"> States</div>
            <table id="divEleStatesList">
                    
            </table>
            
        </span>
        <span id="panelRightElectionDetail">
        
            <div class="tableHeadingInSpan"> Operations </div>
            <button id="btn_delete"> Delete</button> <br>
            <button id="btn_enroll_voters"> Start Election </button><br>
            <button id="btn_enroll_voters"> Stop Election </button><br>
        </span>
    </div>
</div>    

<script type="text/javascript">
			__addTitle = "";
			__addDesc = "";
			__addFromDt = "";
			__addToDt = "";
			
			__detailPageEleId = "";
			
			__allStates = "";
			
			host  = "http://localhost:8080/mvote" ;
			
			_elctionListResponse = "";
			    
			$(document).ready(function()
			{
			    getAllStatesList();
			    showPageHome();
			    
			    $('#goto_search_ele').click(function(){
			        $('#contentAddElectionForm').hide();
			        $('#contentSearchElectionForm').show();
			    });
			    
			    $('#goto_add_ele').click(function(){
			        $('#contentAddElectionForm').show();
			        $('#contentSearchElectionForm').hide();
			    });
			    
			    $('#btn_search_ele').click(function(){
			        searchKey = $("#in_find_ele").val();
			        processElectionsSearch(searchKey);
			    });
			    
			    $('#btn_add_ele').click(function(){
			        processElectionAddition();
			    });
			    
			    $('#btn_add_states').click(function(){
			        submitElectionInfo();
			        //processElectionsSearch();
			        //showPage('#pageElectionSearchSummary');
			    });
			    
			    $('#btn_enroll_voters').click(function(){
			        enrollVotersForElection(__detailPageEleId);
			    });
			    
			    $('#btn_delete').click(function(){
			        electId = "33";
			        deleteElection(__detailPageEleId);
			    });
			
                $('.bck_to_home').click(function(){
                	showPageHome();
                });
			    
			    $("body").on("change", "#pageAddElectionStatesForm input[type=checkbox]", function(event){
			        alert('gotClicked');
			        alert($("#pageAddElectionStatesForm input[type=checkbox]").val());
			    });
			            
			    
			});
			
			
			function deleteElection(electId)
			{
			    obj = { "electId": electId  };
			    jsonString =JSON.stringify(obj);
			    
			    $.ajax({
			        type: "POST",
			        url: host + '/elections/deleteElection',
			        contentType: "application/json; charset=utf-8",
			        dataType: "json",
			        data: jsonString,
			        success: function(response) {
			            populateDeleteElectionStatus(response);
			        },
			        error: function(response){
			            alert("Connection Error. Network failure or Server unavailable");
			        }
			    }); 
			
			}
			
			function populateDeleteElectionStatus(response)
			{
			    if(response.customMessage == "SUCCESS"){
			        alert("Successfully Deleted Election");
			    }
			    else{
			        alert(response.customMessage);
			    }
			
			    
			}
			
			
			
			
			function enrollVotersForElection(electId)
			{
			    obj = { "electId": electId  };
			    jsonString =JSON.stringify(obj);
			    
			    $.ajax({
			        type: "POST",
			        url: host + '/elections/enrollVotersForElection',
			        contentType: "application/json; charset=utf-8",
			        dataType: "json",
			        data: jsonString,
			        success: function(response) {
			            populateVoterEnrollStatus(response);
			        },
			        error: function(response){
			            alert("Connection Error. Network failure or Server unavailable");
			        }
			    }); 
			
			}
			
			function populateVoterEnrollStatus(response)
			{
			    if(response.customMessage == "SUCCESS"){
			        alert("Successfully Enrolled Voters");
			    }
			    else{
			        alert(response.customMessage);
			    }
			
			}
			
		
			
			function submitElectionInfo()
			{
			    obj = { "electTitle":__addTitle ,
			            "electStartDate" : __addFromDt,
			            "electEndDate" : __addToDt,
			            "electDescription" : __addDesc
			          };
			    
			    jsonString =JSON.stringify(obj);
			    
			    $.ajax({
			        type: "POST",
			        url: host + '/elections/addNewElection',
			        contentType: "application/json; charset=utf-8",
			        dataType: "json",
			        data: jsonString,
			        success: function(response) {
			            populateSubmitResult(response);
			        },
			        error: function(response){
			            alert("Connection Error. Network failure or Server unavailable");
			        }
			    }); 
			
			}
			
			
			function populateSubmitResult(response)
			{
			    if(response.customMessage == "SUCCESS"){
			        alert("Successfully added election");
			        showPageHome();
			    }
			    else{
			        alert(response.customMessage);
			    }
			    
			}
			
			
			function getAllStatesList()
			{
			    $.ajax({
			        type: "POST",
			        url: host + '/elections/getAllStates',
			        contentType: "application/json; charset=utf-8",
			        dataType: "json",
			        success: function(response) {
			            __allStates = response.statesList;
			            loadElectionStates(__allStates);
			            
			            //processElectionAddition(__allStates);
			        },
			        error: function(response){
			            alert("Connection Error. Network failure or Server unavailable");
			        }
			    }); 
			}
			
			
			function loadElectionStates()
			{
			    //populate states list
			    
			    strLeft = "";
			    strRight = "";
			    for(i=0; i < __allStates.length; i++)
			    {
			        if(i%2 != 0 )
			        {
			            strLeft +=  " <input type='checkbox' name='check"+ __allStates[i].stateId 
			                    + "' value='"+ __allStates[i].stateId +"'/> "
			                    + __allStates[i].stateName +" <br>" ;
			            //console.log(strLeft);
			        }else{
			            strRight +=  " <input type='checkbox' name='check"+ __allStates[i].stateId 
			                + "' value='"+ __allStates[i].stateId +"'/> "
			                + __allStates[i].stateName +" <br>" ;
			            
			            //console.log(strRight);
			        }
			    }
			
			    $('.statesListLeft').html(strLeft);
			    $('.statesListRight').html(strRight);
			
			    
			    //load elections states on the add elections form dropdown
			}
			
			
			function populateElectionDetail(electId)
			{
			    getElectionDetailBasic(electId);
			    getElectionDetailStates(electId);
			    showPage('#pageElectionDetail');
			
			}
			
			
			function getElectionDetailBasic(electId)
			{
			    obj = { "electId": electId};
			    jsonString =JSON.stringify(obj);
			    
			    $.ajax({
			        type: "POST",
			        url: host + '/elections/getElectionDetail',
			        contentType: "application/json; charset=utf-8",
			        dataType: "json",
			        data: jsonString,
			        success: function(response) {
			            populateBasicElectionDetail(response);
			        },
			        error: function(response){
			            alert("Connection Error. Network failure or Server unavailable");
			        }
			    }); 
			}
			
			function getElectionDetailStates(electId)
			{
			    obj = { "electId":electId };
			    jsonString =JSON.stringify(obj);
			    
			    $.ajax({
			        type: "POST",
			        url: host + '/elections/getStatesListByElection',
			        contentType: "application/json; charset=utf-8",
			        dataType: "json",
			        data: jsonString,
			        success: function(response) {
			            populateStatesElectionDetail(response);
			        },
			        error: function(response){
			            alert("unable to connect");
			        }
			    }); 
			}
			
			
			function populateStatesElectionDetail(response)
			{
				listOfStates = response.statesList;
				
				str = "";
				
				if(response.customMessage = "SUCCESS"){
					for(i=0; i<listOfStates.length; i++){
						str += "<tr><td>";
						str += listOfStates[i].stateName ;
						str += "</td></tr>";
					}
					
				}else{
						str += "<tr><td> "+ response.customMessage +"</td></tr>";
				}
				
				$('#divEleStatesList').html(str);
				
			
			}
			
			function populateBasicElectionDetail(response){
				
				electionDetail = response;
				str = "";
				
				__detailPageEleId = electionDetail.electId;
				
				if(electionDetail.customMessage = "SUCCESS"){
					str += "<tr><td align='right'> Title :</td> <td>" +electionDetail.electTitle + "</td></tr>";
					str += "<tr><td align='right'> Id :</td> <td>" +electionDetail.electId + "</td></tr>";
					str += "<tr><td align='right'> Voter Enrollment status :</td> <td>" +electionDetail.voterEnrollStat + "</td></tr>";
					str += "<tr><td align='right'> Start Date :</td> <td>" +electionDetail.electStartDate + "</td></tr>";
					str += "<tr><td align='right'> End Date :</td> <td>" +electionDetail.electEndDate + "</td></tr>";
					str += "<tr><td align='right'> Description :</td> <td>" +electionDetail.electDescription + "</td></tr>";
				}else{
						str += "<tr><td> "+ electionDetail.customMessage +"</td></tr>";
				}
				
				$('#tableBasicEleDetail').html(str);
			}
			
			
						
			
			function processElectionAddition(){
			    //get inputs , write to db, store info in js var
			    
			    __addTitle = $('#in_add_title').val();
			    __addDesc = $('#in_add_desc').val();
			    __addFromDt = $('#in_add_fromdt').val();
			    __addToDt = $('#in_add_todt').val();
			    
			/*  __addTitle ="autotestbot";
			    __addDesc = "autotestBot";
			    __addFromDt = "1111-11-11";
			    __addToDt = "1111-11-11";
			*/  
			
			    //alert(addTitle +"|"+ addDesc +"|"+ addFromDt +"|"+ addToDt);
			    
			    //populate entered info in the second page
			    if(__addTitle != "" && __addDesc != "" && __addFromDt != "" && __addToDt != "")
			    {
			        str  = "";
			        str += "<tr> <td width='300px' > Election Title :</td>  <td width='400px'>"+ __addTitle +"</td>  </tr>";
			        str += "<tr> <td> Election Description :</td>  <td>"+ __addDesc +"</td>  </tr>";
			        str += "<tr> <td> Election Start Date :</td>  <td>"+ __addFromDt +"</td>  </tr>";
			        str += "<tr> <td> Election End Date :</td>  <td>"+ __addToDt +"</td>  </tr>";
			        str += "<tr> <td> States Selected :</td>  <td> All States </td>  </tr>";
			        
			        showPage('#pageAddElectionStatesForm');
			        $('#tbl_basicElectionInfoAdd').html(str);
			    
			    }else{
			        alert("All fields are mandatory. Please resubmit");
			    }
			}
			
			function processElectionsSearch(searchKey){
			    obj = { "electTitle": searchKey };
			    jsonString =JSON.stringify(obj);
			    
			    $.ajax({
			        type: "POST",
			        url: host + '/elections/searchElection',
			        contentType: "application/json; charset=utf-8",
			        dataType: "json",
			        data: jsonString,
			        success: function(response) {
			        	_elctionListResponse = response;
			            populateElectionList(response);
			        },
			        error: function(response){
			            alert("Connection Error. Network failure or Server unavailable");
			        }
			    }); 
			}
			
			
			
			function populateElectionList(response)
			{
			 	str = "";
			    if(response.customMessage == "SUCCESS")
			    {
			        _elctionList = response.electionBasicDetailList;
			        for(i=0; i< _elctionList.length; i++){
			                str += "<tr>" ;
			                str +=  "<td><a onclick=populateElectionDetail("+ _elctionList[i].electId+")>"
			                			+ _elctionList[i].electId +"</a></a></td>" ;
			                str +=  "<td>"+ _elctionList[i].electTitle+"</td><td>"+ _elctionList[i].electStartDate+"</td>" ;
			                str +=  "<td>"+_elctionList[i].electEndDate+"</td><td>"+ _elctionList[i].voterEnrollStat+"</td>" ;
			                str += "</tr>" ;
			        }
			    }else {
			        str += "<tr><td colspan='5'>"+ response.customMessage +"</td></tr>"; 
			    }
			    
			    $('#tableElectionsSearchResults tbody').html(str);
			    showPage('#pageElectionSearchSummary');
			
			}
			
	
			function hideAll(){
			    $('#pageElectionsHome').hide();
			    $('#pageAddElectionStatesForm').hide();
			    $('#pageElectionSearchSummary').hide();
			    $('#pageElectionDetail').hide();
			}
			
			function showPage(pageId){
			    hideAll();
			    $(pageId).show();
			}
			
			function showPageHome(){
			    hideAll();
			    $('#pageElectionsHome').show();
			        $('#contentAddElectionForm').hide();
			            $('#contentSearchElectionForm').show();
			}





</script>
